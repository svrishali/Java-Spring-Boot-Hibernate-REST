<?xml version="1.0" encoding="utf-8"?>

<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN"
 "../dtd/task.dtd">
<!-- 
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at      

   http://www.apache.org/licenses/LICENSE-2.0  

Unless required by applicable law or agreed to in writing, software  
distributed under the License is distributed on an "AS IS" BASIS,  
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  
See the License for the specific language governing permissions and  
limitations under the License.
-->
<task id="tdevdvlp40464" xml:lang="en-us">
<title>Shutting down Derby or an individual database</title>
<shortdesc>Applications in an embedded environment shut down the <ph conref="../conrefs.dita#prod/productshortname"></ph> system
by specifying the <i>shutdown=true</i> attribute in the connection URL. To
shut down the system, you do not specify a database name, and you do not
ordinarily specify any other attribute.</shortdesc>
<prolog><metadata>
<keywords><indexterm>Shutting down a single database</indexterm><indexterm>Shutting
down Derby<indexterm>using database connection URL attribute</indexterm></indexterm>
<indexterm>Databases<indexterm>shutting down individually</indexterm></indexterm>
</keywords>
</metadata></prolog>
<taskbody>
<context> <codeblock>jdbc:derby:;<ph>shutdown=true</ph></codeblock><p>A successful
shutdown always results in an <i>SQLException</i> to indicate that <ph conref="../conrefs.dita#prod/productshortname"></ph> has
shut down and that there is no other exception.</p>
<p>If you are running with a security manager on JDK 8 or higher, you must grant
<ph conref="../conrefs.dita#prod/productshortname"></ph> permission to
deregister the embedded driver in order to fully shut down the system. See
"Configuring Java security" in the <ph conref="../conrefs.dita#pub/citsec"></ph>
for details.</p>
<p>If you have enabled user authentication at the system level, you will need to
specify credentials (that is, username and password) in order to shut down a
<ph conref="../conrefs.dita#prod/productshortname"></ph> system, and the
supplied username and password must also be defined at the system level.</p>
<p>You can also shut down
an individual database if you specify the <i>databaseName</i>. You can shut
down the database of the current connection if you specify the default connection
instead of a database name<i> </i>(within an SQL statement).</p><codeblock><b>// shutting down a database from your application</b>
DriverManager.getConnection(
    "jdbc:derby:sample;shutdown=true");</codeblock>
<p>If user authentication and SQL authorization are both enabled, only the
database owner can shut down the database. (See the
<ph conref="../conrefs.dita#pub/citsec"></ph> for details on authentication and
authorization.)</p>
<codeblock><b>// shutting down an authenticated database as database owner</b>
DriverManager.getConnection(
    "jdbc:derby:securesample;user=joeowner;password=secret;shutdown=true");</codeblock>
<p>If you previously called the <i>java.sql.DriverManager.setLoginTimeout</i>
method to enable a login timeout, a shutdown of
<ph conref="../conrefs.dita#prod/productshortname"></ph> or of an individual
database can fail under circumstances like the following:</p>
<ul>
<li>Network problems which slow down LDAP authentication</li>
<li>Heavily loaded databases which take a long time time to quiesce</li>
</ul>
<p>
<note type="attention"> 
It is good practice to close existing connections before shutting down 
the system or database. Connections created before the shutdown will not 
be usable after shutdown is performed.  Attempting to access  connections 
after shutdown may cause errors including instances of 
<codeph>NullPointerException</codeph> or protocol violations. 
</note>
</p>
</context>
</taskbody>
</task>
